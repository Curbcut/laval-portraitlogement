---
title: "Targets"
author: "Curbcut"
output: html_document
---

```{r setup_targets, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
qs::qload(here::here("data", "targets.qsm"))
library(tidyverse)
library(gt)
library(patchwork)
source(here::here("R/utils/startup.R"))

```

# Housing targets modelling strategy

To answer the question "how many housing units should the City of Laval be building each year", it is necessary to first answer two other questions. The first is "how many households are expected (or desired) to be living in the City each year". The second is "how many dwelling units will it be necessary to build to ensure that there is sufficient housing for that number of households".

We answer the first question by using the three scenarios for household growth to 2051 in the City of Laval which have been produced by the ISQ: a reference scenario, a weak scenario, and a strong scenario. We answer the second question by using historical trends to model a set of factors related to dwelling occupancy, housing construction and demolition, and household housing preferences.

Below we present the detailed steps involved in this modeling exercise, along with the resulting housing targets. But first we identify a set of important qualifications about what can and cannot be inferred from this analysis.

First, it is important to be clear about what the ISQ household growth scenarios mean, and how they are incorporated into our housing targets. These scenarios represent the ISQ's best guess about how a range of factors at the local, regional, provincial, national and global scales will translate into household formation in Laval, and, given the inherent uncertainty in those factors, represent a rough guide to several currently plausible outcomes. However, a fundamental limitation of using the ISQ's household projections to guide City housing policy is that City housing policy is implicitly one of the most important inputs to these projections. Under all of its scenarios, the ISQ is assuming that there will be more households in Laval in 2051 than there are today, and under two of the three scenarios the number of households is expected to continue increasing each year. However, household growth can only occur if the City permits sufficient new housing construction. For example, if the City decides to permit no new housing construction between now and 2051, then the number of households in Laval will stagnate and likely decline (thanks to building attrition), regardless of what the ISQ projects. More realistically, if the City only permits sufficient housing construction to reach half the number of new households that the ISQ projects will be present in Laval in 2051, then the number of households will necessarily fall short of the ISQ projection.

The housing targets produced in this analysis should therefore be understood as the targets which will allow the ISQ projections to be realized, subject to the ISQ's other assumptions remaining plausible (e.g. the Québec population ages as it is expected to, and immigration proceeds as it is expected to) and subject to the housing dynamics captured in the remainder of our model. If the City has different normative goals for household growth in Laval, those can be substituted into the model in place of the ISQ's projections, and the model will produce the resulting targets for the amount of housing construction necessary to realize those household growth goals.

Second, it is important to clarify which housing outcomes the City has some control over, and how. The key dynamics of housing systems are regional in nature; in particular, the region is the scale at which aggregate housing demand is produced, and the scale at which demand and supply jointly determine housing costs. This is because households are much more indifferent to their location within a region than they are to their location between regions: in the case of the Montreal region, while each individual household is likely to have some preferences as to whether they live in Laval or Longueuil or elsewhere, in general households' locational choices are most strictly limited by daily commuting needs which anchor them to a given region. It is plausible to commute from Laval to Longueuil or vice-versa, but it is not plausible to commute from Laval to Quebec City, or from Laval to Ottawa.

Aggregate housing demand is the amount of housing desired at different price points by all the households currently living in the region or interested in living in the region (plus the housing desired by non-local investors). If the amount of this demand increases (for example because the Montreal economy is booming, because the Montreal region becomes a more attractive destination for international migration, or because national interest rates drop), then, given a fixed amount of regional housing supply, regional housing costs will increase. Likewise, as any location in the region adds housing supply, then, given a fixed amount of regional housing demand, regional housing costs will decrease. While a new influx of housing in a particular location will likely result in a short-term drop in housing costs relative to other locations in the region which did not receive that influx, in the long run the downward price pressure of new supply will tend to equilibriate across the entire region, as individual households' locational preferences update in response to changing prices.

The result of this regional housing price equilibrium process is that, broadly speaking, local housing costs are jointly driven by, on the one hand, the relationship between regional demand and supply (which answers the question: how costly is housing in general?), and, on the other, the relative desirability of its housing vis-a-vis the housing elsewhere in the region (which answers the question: given baseline regional housing costs, how much more or less expensive is local housing because of its relative desirability?).

The key implication of this analysis for the City of Laval is that the City's major lever for affecting housing affordability is the type of construction rather than the volume of construction it allows. are twofold. First, while it is intuitive that the City has minimal control over aggregate housing demand in the Montreal region, it is also true that the City has minimal control over aggregate housing supply in the region. If Laval were to receive a boom in new housing construction, some of the resulting supply would tend to reduce housing costs in Laval, but much of that supply would reduce housing costs elsewhere in the Montreal region. a locally significant 

Specifically, the main policy lever the City has over housing affordability is deciding what percentage of new housing development will be multi-family. On



Second, TKTK regional issue: the important housing system dynamics are happening at a regional scale, and Laval gets a certain proportion of those dynamics




TKTK

# The housing targets model

We estimate the required amount of new housing construction in Laval each year with the following model:

$$
HC_t = \frac{HH_t}{OR_t} - D_{t-1}*(1-AR)
$$
Where $t$ is the year, $HC_t$ is the number of new housing completions, $HH_t$ is the number of households, $OR_t$ is the occupancy rate of private dwelling units, $D_{t-1}$ is the number of private dwelling units in the previous year, and $AR$ is the attrition rate of private dwelling units.


# ISQ household projections

```{r isq}
max_weak <- 
  isq |> 
  filter(scenario == "weak") |> 
  filter(value == max(value)) |> 
  pull(year)

```

The ISQ maintains three projections for the future growth in households in Québec's administrative regions: a reference scenario, a weak scenario (which forecasts slower household growth than the reference scenario), and a strong scenario (which forecasts faster household growth). These three scenarios form the basis for our housing targets. Figure TKTK displays the number of households forecasted in the City of Laval each year from 2021 (the base year) to 2051 under the three scenarios. The figure demonstrates that, while the reference and strong scenarios each project monotonic household growth throughout the study period, under the weak scenario total households are foreceasted to begin declining after `r max_weak`. This will have important implications for housing production targets under this scenario.

```{r plot_isq_households}
plot_isq_households
```


# Occupancy rate

```{r occ_rate}

occ_2001 <- 
  occ_rate |> 
  filter(year == 2001) |> 
  pull(occ_rate) |> 
  convert_pct()

occ_2021 <- 
  occ_rate |> 
  filter(year == 2021) |> 
  pull(occ_rate) |> 
  convert_pct()

```

If the ISQ household projections are to be realized, each of these future households will require a dwelling unit to occupy. However, in reality the City will require somewhat more than one dwelling unit per household, since every housing market has some number of unoccupied dwelling units. For rental apartments, these unoccupied units are the basis for the rental vacancy rate, but in the ownership sector as well unoccupied units are a standard feature of a healthy housing market.

The ratio of occupied private dwelling units to all private dwelling units is the occupancy rate, and it can be measured empirically using the Canadian Census. The census provides a count of all private dwelling units, derived from the Statistical Building Register which Statistics Canada uses to produce the sampling frame for the census. It also provides a count of households, which is identical to the number of occupied private dwelling units (since households are defined as private dwellings occupied by usual residents). The ratio of the latter measure to the former is the occupancy rate.

Historically, the occupancy rate has been declining in Laval; in other words, over time, a smaller percentage of total dwelling units have been occupied by their usual residents when the census was taken. In 2001, the occupancy rate was `r occ_2001`, while it had declined to `r occ_2021` by 2021. This trend is plausibly linear; the linear correlation between the year and the occupancy rate is in fact `r round(sqrt(summary(occ_model)$r.squared), 3)`. Under a linear trend, we should expect to see the occupancy rate decline steadily over the study period. However, the trend is also potentially exponential, which would imply a progressively slowing decline in the occupancy rate over the study period. It is not possible to empirically adjudicate between these possibilities, so instead we adopt them as two scenarios: a strong scenario where the occupancy rate is assumed to decline according to the linear function occ_rate = `r occ_model$coefficients["(Intercept)"][[1]]` `r occ_model$coefficients["year"][[1]]` * year, and a weak scenario where the occupancy rate is assumed to decline according to the decaying exponential function occ_rate = 0.954 + 0.01 * 0.958 ^ (year - 2021). These scenarios are each illustrated in Figure TKTK.

```{r plot_occ_rate}
plot_occ_rate
```


# Total required dwelling units

For each of the ISQ's scenarios of household growth, the ratio of the number of projected households to the projected occupancy rate (HH / OR) yields a required number of total dwelling units. For each of the three ISQ scenarios (reference, weak and strong) there are two total dwelling unit scenarios, corresponding to the two occupancy rate scenarios (weak and strong). Figure TKTK shows these values; since the ISQ's weak scenario implies a shrinking number of households after 2037, total required dwellings in this scenario also begin to shrink, even taking into account a potentially declining occupancy rate.

```{r plot_dwelling_targets}
plot_dwelling_targets
```


# Existing dwelling units

To transalte the total required dwelling units each year into targets for housing production, we first need to estimate the number of 

